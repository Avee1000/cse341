<% if (errors) { %>
<ul class="notice">
    <% errors.array().forEach(error => { %>
    <li><%= error.msg %></li>
    <%  }) %>
</ul>
<% } %>


<div class="update-container">
    <h1>Update Account Information</h1>
    <h4>
        <%- messages() %>
    </h4>


    <form action="/account/updateAccount" method="POST">
        <input type="number" name="account_id" value="<%= locals.account_id %>" hidden>

        <label for="first_name">First name</label>
        <input type="text" id="first_name" name="account_firstname" required autocomplete="given-name"
            value="<%= locals.account_firstname %>">

        <label for="last_name">Last name</label>
        <input type="text" id="last_name" name="account_lastname" required autocomplete="family-name"
            value="<%= locals.account_lastname %>">

        <label for="email">Email address</label>
        <input type="email" id="email" name="account_email" required placeholder="Enter a valid email address"
            value="<%= locals.account_email %>">

        <button type="submit" disabled>Update account</button>
    </form>


    <form action="/account/updatePassword" method="POST">
        <input type="number" name="account_id" value="<%= locals.account_id %>" hidden>


        <label for="password">Create New Password</label>
        <div class="password-wrapper">
            <input type="password" 
                id="password" 
                name="account_password" 
                required minlength="12"
                pattern="^(?=.*[A-Z])(?=.*\d)(?=.*[^\w\s]).{12,}$"
                title="Password must be at least 12 characters, contain 1 capital letter, 1 number, and 1 special character">
            <span class="toggle-password" onclick="togglePassword()">👁️</span>
        </div>


        <label for="password">Confirm New Password</label>
        <input type="password" id="passwordConfirm" name="account_password_confirm" required minlength="12"
            pattern="^(?=.*[A-Z])(?=.*\d)(?=.*[^\w\s]).{12,}$">

        <button type="submit">Update password</button>
    </form>

</div>

<script>
  function togglePassword() {
    const pwd = document.getElementById("password")
    const icon = document.querySelector(".toggle-password")
    if (pwd.type === "password") {
      pwd.type = "text"
      icon.textContent = "🙈"
    } else {
      pwd.type = "password"
      icon.textContent = "👁️"
    }
  }
</script>
<script src="/js/inv-update.js"></script>
